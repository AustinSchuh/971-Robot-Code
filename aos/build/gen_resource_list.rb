outpath = ARGV.shift

outputh = File.new(outpath + '/ResourceList.h', 'w+')

File.open(File.dirname(__FILE__) + '/../atom_code/ipc_lib/resource_list.txt') do |f|
	outputh.puts <<END
#ifndef __AOS_RESOURCE_LIST_H_
#define __AOS_RESOURCE_LIST_H_
// This file is autogenerated.
// Edit #{File.expand_path f.path} to change its contents.

#include <stdint.h>

#ifdef __cplusplus // for the c code that just wants to know how long it should be
namespace aos {
END

	i = 0
	f.readlines.each do |l|
		l = l.chomp
		outputh.puts "static const uint16_t #{l}(#{i});"
		i += 1
	end
	outputh.puts <<END
} // namespace aos
#endif

#define AOS_RESOURCE_NUM #{i}

#endif

END
end

outputh.close

